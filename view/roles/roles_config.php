<?phpinclude_once('../../utils/usr_permission.php');$up = new UsrPermission();$up->requestAccessPage(PermissionType::ROLES);include_once('../../controller/c_roles.php');$control = new ControllerRoles();$user_id = trim($_GET['id']);?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><script>$(document).ready(function() {		$('.check_admim').change(function(){		var obj = $(this).attr('obj');				if( $('#' + obj + '_add').is(':checked') || $('#' + obj + '_delete').is(':checked') )		{			$('#' + obj + '_view').prop('checked', true);			$('#' + obj + '_view').prop('disabled', true);		}		else			$('#' + obj + '_view').prop('disabled', false);	});		$('#bSaveConfig').click(function(){		$.post("roles/roles_form.php", $('#fRoles').serialize(), function(data){			loadPage('infos/data_saved.php');		});	});});</script></head><body><table border="1" align="center"><?phpif( !empty($user_id) ){	$permissionsArr = $control->getUserPermissions($user_id);		foreach($permissionsArr as $role){?><tr>		<th colspan='3'>&nbsp;		<input type='hidden' name='hUserId' value='<?php echo $user_id; ?>'>		</th>	</tr>	<tr>		<th colspan='3'>ADMINISTRATIVOS</th>	</tr>	<tr>		<th align='left'>Permisos:</th>		<td align='center'>			<select name="sPermissions">				<option value='x' <?php if($role['permission'] == 'x') echo 'selected'; ?> >No</option>				<option value='y' <?php if($role['permission'] == 'y') echo 'selected'; ?> >Si</option>			</select>		</td>		<td>			Permitir que el usuario pueda configurar permisos para otros usuarios, incluyendolo.<br>			Pero cuidado, un gran poder conlleva una gran responsabilidad :) .		</td>	</tr>	<tr>		<th align='left'>Dep&oacute;sitos:</th>		<td>			<input type="checkbox" name="store_view" id="store_view" value="ver" <?php if($role['store_a'] == 'y' || $role['store_d'] == 'y') echo 'checked disabled'; else if($role['store_v'] == 'y') echo 'checked'; ?> >Ver<br>			<input type="checkbox" name="store_add" id="store_add" class='check_admim' obj='store' value="agregar" <?php if($role['store_a'] == 'y') echo 'checked'; ?> >Ver/Agregar/Modificar<br>			<input type="checkbox" name="store_delete" id="store_delete" class='check_admim' obj='store' value="eliminar" <?php if($role['store_d'] == 'y') echo 'checked'; ?> >Ver/Eliminar		</td>		<td>			Permitir que el usuario pueda ver/agregar/modificar y/o eliminar dep&oacute;sitos.		</td>	</tr>	<tr>		<th align='left'>Tiendas:</th>		<td>			<input type="checkbox" name="shop_view" id="shop_view" value="ver" <?php if($role['shop_a'] == 'y' || $role['shop_d'] == 'y') echo 'checked disabled'; else if($role['shop_v'] == 'y') echo 'checked'; ?> >Ver<br>			<input type="checkbox" name="shop_add" id="shop_add" class='check_admim' obj='shop' value="agregar" <?php if($role['shop_a'] == 'y') echo 'checked'; ?> >Ver/Agregar/Modificar<br>			<input type="checkbox" name="shop_delete" id="shop_delete" class='check_admim' obj='shop' value="eliminar" <?php if($role['shop_d'] == 'y') echo 'checked'; ?> >Ver/Eliminar		</td>		<td>			Permitir que el usuario pueda ver/agregar/modificar y/o eliminar tiendas.<br>			Si elige agregar o eliminar, ademas el usuario podr&aacute; cambiar fecha en la(s) tiendas.		</td>	</tr>	<tr>		<th align='left'>Llantas:</th>		<td>			<input type="checkbox" name="tyre_add" id="tyre_add" value="agregar" <?php if($role['tyre_a'] == 'y') echo 'checked'; ?> >Agregar/Modificar<br>			<input type="checkbox" name="tyre_delete" id="tyre_delete" value="eliminar" <?php if($role['tyre_d'] == 'y') echo 'checked'; ?> >Eliminar		</td>		<td>			Permitir que el usuario pueda agregar/modificar y/o eliminar llantas.		</td>	</tr>	<tr>		<th align='left'>Importadores:</th>		<td>			<input type="checkbox" name="supplier_add" id="supplier_add" value="agregar" <?php if($role['supplier_a'] == 'y') echo 'checked'; ?> >Agregar/Modificar<br>			<input type="checkbox" name="supplier_delete" id="supplier_delete" value="eliminar" <?php if($role['supplier_d'] == 'y') echo 'checked'; ?> >Eliminar		</td>		<td>			Permitir que el usuario pueda agregar/modificar y/o eliminar importadores.		</td>	</tr>	<tr>		<th align='left'>Deudores</th>		<td>			<input type="checkbox" name="deptor_add" id="deptor_add" value="agregar" <?php if($role['deptor_a'] == 'y') echo 'checked'; ?> >Agregar/Modificar<br>			<input type="checkbox" name="deptor_delete" id="deptor_delete" value="eliminar" <?php if($role['deptor_d'] == 'y') echo 'checked'; ?> >Eliminar		</td>		<td>			Permitir que el usuario pueda agregar/modificar y/o eliminar deudores.		</td>	</tr>	<?php	} //End foreach	?>		<tr>		<th colspan='3'>&nbsp;</th>	</tr>	<tr>		<th colspan='3'>MOVIMIENTOS</th>	</tr>	<?php	$storePermissionsArr = $control->getUserStorePermissions($user_id);	$storeArr = $control->getStoresArray();		foreach($storeArr as $store)	{		$id = $store['id'];		if( isset($storePermissionsArr[$id]) )			$permissions = $storePermissionsArr[$id];		else			$permissions['mov_v'] = $permissions['mov_a'] = $permissions['mov_d'] = 'x';	?>	<tr>		<th align='left'>Dep&oacute;sito <?php echo $store['name'];?>:</th>		<td>			<input type="checkbox" name="mov_store_<?php echo $id;?>_view" id="mov_store_<?php echo $id;?>_view" value="ver" <?php if($permissions['mov_a'] == 'y' || $permissions['mov_d'] == 'y') echo 'checked disabled'; else if($permissions['mov_v'] == 'y') echo 'checked'; ?>  >Ver<br>			<input type="checkbox" name="mov_store_<?php echo $id;?>_add" id="mov_store_<?php echo $id;?>_add" class='check_admim' obj='mov_store_<?php echo $id;?>' value="agregar" <?php if($permissions['mov_a'] == 'y') echo 'checked'; ?> >Ver/Agregar/Modificar<br>			<input type="checkbox" name="mov_store_<?php echo $id;?>_delete" id="mov_store_<?php echo $id;?>_delete" class='check_admim' obj='mov_store_<?php echo $id;?>' value="eliminar" <?php if($permissions['mov_d'] == 'y') echo 'checked'; ?> >Ver/Eliminar		</td>		<td>			Permitir que el usuario pueda ver/agregar/modificar y/o eliminar movimientos en el dep&oacute;sito <?php echo $store['name']; ?>.		</td>	</tr>	<?php } ?>		<?php	$shopPermissionsArr = $control->getUserShopPermissions($user_id);	$shopArr = $control->getShopsArray();		foreach($shopArr as $shop)	{		$id = $shop['id'];		if( isset($shopPermissionsArr[$id]) )			$permissions = $shopPermissionsArr[$id];		else			$permissions['mov_v'] = $permissions['mov_a'] = $permissions['mov_d'] = $permissions['mov_o'] = 'x';	?>	<tr>		<th align='left'>Tienda <?php echo $shop['name'];?>:</th>		<td>			<input type="checkbox" name="mov_shop_<?php echo $id;?>_view" id="mov_shop_<?php echo $id;?>_view" value="ver" <?php if($permissions['mov_a'] == 'y' || $permissions['mov_d'] == 'y') echo 'checked disabled'; else if($permissions['mov_v'] == 'y') echo 'checked'; ?> >Ver<br>			<input type="checkbox" name="mov_shop_<?php echo $id;?>_add" id="mov_shop_<?php echo $id;?>_add" class='check_admim' obj='mov_shop_<?php echo $id;?>' value="agregar" <?php if($permissions['mov_a'] == 'y') echo 'checked'; ?> >Ver/Agregar/Modificar<br>			<input type="checkbox" name="mov_shop_<?php echo $id;?>_delete" id="mov_shop_<?php echo $id;?>_delete" class='check_admim' obj='mov_shop_<?php echo $id;?>' value="eliminar" <?php if($permissions['mov_d'] == 'y') echo 'checked'; ?> >Ver/Eliminar<br>			<input type="checkbox" name="mov_shop_<?php echo $id;?>_out" id="mov_shop_<?php echo $id;?>_out" class='check_admim' obj='mov_shop_<?php echo $id;?>' value="salidas" <?php if($permissions['mov_o'] == 'y') echo 'checked'; ?> >Salidas		</td>		<td>			Permitir que el usuario pueda ver/agregar/modificar/eliminar movimientos y realizar salidas en la tienda <?php echo $shop['name']; ?>.		</td>	</tr>	<?php } ?>		<tr>		<th colspan="3"><input type="button" id="bSaveConfig" value="Guardar permisos" /></th>	</tr><?php 	} //End if ?></table></body>